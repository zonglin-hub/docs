# Linux 批量删除文件

> 需求：我的想法是删除所有包含 'category: 新闻' 内容的文件。首先我使用 `rg 'category: 新闻'` 筛选除了这些。

```log
2020/10/12726.md
3:category: 新闻

2023/10/16244.md
3:category: 新闻

2023/10/16300.md
3:category: 新闻

2023/10/16275.md
3:category: 新闻

2023/10/16323.md
3:category: 新闻

2023/10/16303.md
3:category: 新闻

2023/10/16290.md
3:category: 新闻

2023/10/16281.md
3:category: 新闻
```

> 需求：这些文本中，我想获取类似 `2014/07/3363.md`

如果您想要从一行文本中提取文件名 `2014/07/3363.md`，您可以使用 `awk` 命令。
假设这行文本是存储在一个文件中，或者通过管道传递给 `awk`，您可以使用以下命令来提取文件名：

```bash
echo "2014/07/3363.md:category:" | awk -F: '{print $1}'
```

这里，`-F:` 参数指定了冒号 `:` 作为字段分隔符，`'{print $1}'` 指定了打印第一个字段，即文件名。
如果这行文本是直接作为输入，您可以通过管道将文本传递给 `awk`：

```bash
echo "2014/07/3363.md:category:" | awk -F: '{print $1}'
```

或者，如果您想要从文件中提取这行文本，您可以这样做：

```bash
awk -F: '{print $1}' filename.txt
```

这里 `filename.txt` 是包含文本的文件名。
如果您只是想要从一行文本中提取文件名，而不关心文件内容的获取，那么上面的 `awk` 命令就是您需要的。
如果您确实想要获取该文件的内容，您可以使用前面提到的 `cat`、`more` 或 `less` 命令，
但前提是您有一个实际的文件 `2014/07/3363.md` 存在于您的文件系统中。

> 需求：这条命令筛选出很多这类文件，我想把他们全部删除

如果您已经使用命令筛选出了一系列文件，并且想要删除这些文件，您可以使用 `xargs` 命令来传递文件列表给 `rm` 命令。以下是一个例子：
假设您已经使用了一个命令，比如 `grep`，来筛选出所有以 `.md` 结尾的文件，并将它们传递给 `xargs`。例如：

```bash
grep -l ':category:' *.md | xargs rm
```

这里，`grep -l ':category:' *.md` 会列出所有包含 `:category:` 并且以 `.md` 结尾的文件。
然后，`xargs rm` 会将这些文件名传递给 `rm` 命令，从而删除这些文件。
请注意，`xargs` 默认会在每个参数周围加上双引号，这样即使文件名包含空格也能正确处理。
如果您想要在删除之前确认文件名，可以将 `rm` 命令替换为 `echo` 命令来预览将会删除哪些文件：

```bash
grep -l ':category:' *.md | xargs echo
```

当您确认无误后，去掉 `echo` 并替换为 `rm` 执行删除操作。
请务必小心使用 `rm` 命令，特别是在结合 `xargs` 使用时，因为一旦执行，这些文件将被永久删除，且无法恢复。
在执行删除操作之前，请确保您的命令是正确的，并且您已经备份了不需要删除的文件。

最终命令：

```shell
rg 'category: 新闻' | awk {'print $1'}  | awk -F: '{print $1}' | xargs rm
```
